{% load wagtailcore_tags wagtailimages_tags %}

<header class="section ">
    <div class="container mx-auto px-4 md:px-8 ">
        {% for block in page.global_presence %}
            {% if block.block_type == 'presence' %}
                <div class=" mb-12">
                    <h2 class="heading_h2">{{ block.value.title|default:"Глобальное присутствие" }}</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="rich-text w-richtext rich-content  heading_h4">
                            {% if block.value.description %}
                                {{ block.value.description|richtext }}
                                
                            {% else %}
                                <p>Мы работаем в более чем 10 странах, предоставляя инновационные решения для автоматизации бизнеса. Наши эксперты обеспечивают локальную поддержку и адаптацию систем под ваши потребности.</p>
                            {% endif %}
                        </div>
                    <div class="image-ratio ">
                        {% image block.value.image width-1920 height-1080 as presence_img %}
                        <img src="{{ presence_img.url }}" 
                             alt="{{ block.value.title|default:'Глобальное присутствие' }}" 
                             loading="lazy" 
                             class="w-full h-full object-cover rounded-lg">
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>
</header>

<style>
    /* === RICHTEXT — ОПИСАНИЕ (ФОТО МЕЖДУ ТЕКСТОМ) === */
    .rich-content {
        font-size: 1.125rem;
        line-height: 2;
        color: inherit;
    }
    .rich-content > * + * { margin-top: 1.5rem; }
    .rich-content p { margin-bottom: 1.5rem; }

    /* ФОТО — ПОТОКОВО, МЕЖДУ АБЗАЦАМИ */
    .rich-content img {
        display: block;
        width: 100%;
        height: auto;
        border-radius: 16px;
        border: 1px solid rgba(239,68,68,0.2);
    }

    /* СПИСКИ (для Задачи/Решения) */
    .rich-content ul {
        list-style: none;
        padding-left: 0;
        margin: 1.5rem 0;
    }
    .rich-content ul > li {
        position: relative;
        padding-left: 2.5rem;
        margin-bottom: 1.2rem;
        line-height: 1.8;
    }
    .rich-content ul > li::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0.75rem;
        width: 12px;
        height: 12px;
        border: 2px solid #ef4444;
        border-radius: 50%;
        background: transparent;
    }
    .rich-content ul.filled > li::before {
        background: #ef4444;
        border-color: #ef4444;
    }

    /* НУМЕРОВКА */
    .rich-content ol {
        counter-reset: list-item;
        list-style: none;
        padding-left: 0;
        margin: 1.5rem 0;
    }
    .rich-content ol > li {
        counter-increment: list-item;
        position: relative;
        padding-left: 2.5rem;
        margin-bottom: 1.2rem;
        line-height: 1.8;
    }
    .rich-content ol > li::before {
        content: counter(list-item) ".";
        position: absolute;
        left: 0;
        color: #ef4444;
        font-weight: bold;
        font-size: 1.1em;
    }

.results-blocks {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
}
.result-block {
    background: rgba(31, 41, 55, 0.7);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(239, 68, 68, 0.4);
    border-radius: 16px;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
}
.result-block:hover {
    border-color: #ef4444;
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.25);
}
.result-block .icon {
    width: 48px;
    height: 48px;
    border: 2px solid #ef4444;
    border-radius: 12px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    margin-bottom: 1rem;
}
.result-block .icon svg {
    width: 28px;
    height: 28px;
    color: #ef4444;
}
.result-block .text {
    flex: 1;
    line-height: 1.6;
    font-size: 1.1rem;
}
.result-block strong {
    color: #fca5a5;
    font-weight: 600;
}

.rich-content img {
    display: block;
    max-width: 100%;
    height: auto;
    margin: 2rem auto;
    border-radius: 16px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.3);
    border: 1px solid rgba(239,68,68,0.2);
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    transform: translateZ(0);
}

</style>